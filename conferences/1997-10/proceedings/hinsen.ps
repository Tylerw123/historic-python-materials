%!PS-Adobe-2.0
%%Creator: dvipsk 5.58f Copyright 1986, 1994 Radical Eye Software
%%Title: paper.dvi
%%Pages: 7
%%PageOrder: Ascend
%%BoundingBox: 0 0 612 792
%%DocumentFonts: Times-Bold Times-Roman Times-Italic Courier
%%DocumentPaperSizes: Letter
%%EndComments
%DVIPSCommandLine: dvips -t letter -o paper.ps paper.dvi
%DVIPSParameters: dpi=600, comments removed
%DVIPSSource:  TeX output 1997.09.09:1941
%%BeginProcSet: tex.pro
/TeXDict 250 dict def TeXDict begin /N{def}def /B{bind def}N /S{exch}N
/X{S N}B /TR{translate}N /isls false N /vsize 11 72 mul N /hsize 8.5 72
mul N /landplus90{false}def /@rigin{isls{[0 landplus90{1 -1}{-1 1}
ifelse 0 0 0]concat}if 72 Resolution div 72 VResolution div neg scale
isls{landplus90{VResolution 72 div vsize mul 0 exch}{Resolution -72 div
hsize mul 0}ifelse TR}if Resolution VResolution vsize -72 div 1 add mul
TR[matrix currentmatrix{dup dup round sub abs 0.00001 lt{round}if}
forall round exch round exch]setmatrix}N /@landscape{/isls true N}B
/@manualfeed{statusdict /manualfeed true put}B /@copies{/#copies X}B
/FMat[1 0 0 -1 0 0]N /FBB[0 0 0 0]N /nn 0 N /IE 0 N /ctr 0 N /df-tail{
/nn 8 dict N nn begin /FontType 3 N /FontMatrix fntrx N /FontBBox FBB N
string /base X array /BitMaps X /BuildChar{CharBuilder}N /Encoding IE N
end dup{/foo setfont}2 array copy cvx N load 0 nn put /ctr 0 N[}B /df{
/sf 1 N /fntrx FMat N df-tail}B /dfs{div /sf X /fntrx[sf 0 0 sf neg 0 0]
N df-tail}B /E{pop nn dup definefont setfont}B /ch-width{ch-data dup
length 5 sub get}B /ch-height{ch-data dup length 4 sub get}B /ch-xoff{
128 ch-data dup length 3 sub get sub}B /ch-yoff{ch-data dup length 2 sub
get 127 sub}B /ch-dx{ch-data dup length 1 sub get}B /ch-image{ch-data
dup type /stringtype ne{ctr get /ctr ctr 1 add N}if}B /id 0 N /rw 0 N
/rc 0 N /gp 0 N /cp 0 N /G 0 N /sf 0 N /CharBuilder{save 3 1 roll S dup
/base get 2 index get S /BitMaps get S get /ch-data X pop /ctr 0 N ch-dx
0 ch-xoff ch-yoff ch-height sub ch-xoff ch-width add ch-yoff
setcachedevice ch-width ch-height true[1 0 0 -1 -.1 ch-xoff sub ch-yoff
.1 sub]{ch-image}imagemask restore}B /D{/cc X dup type /stringtype ne{]}
if nn /base get cc ctr put nn /BitMaps get S ctr S sf 1 ne{dup dup
length 1 sub dup 2 index S get sf div put}if put /ctr ctr 1 add N}B /I{
cc 1 add D}B /bop{userdict /bop-hook known{bop-hook}if /SI save N @rigin
0 0 moveto /V matrix currentmatrix dup 1 get dup mul exch 0 get dup mul
add .99 lt{/QV}{/RV}ifelse load def pop pop}N /eop{SI restore userdict
/eop-hook known{eop-hook}if showpage}N /@start{userdict /start-hook
known{start-hook}if pop /VResolution X /Resolution X 1000 div /DVImag X
/IE 256 array N 0 1 255{IE S 1 string dup 0 3 index put cvn put}for
65781.76 div /vsize X 65781.76 div /hsize X}N /p{show}N /RMat[1 0 0 -1 0
0]N /BDot 260 string N /rulex 0 N /ruley 0 N /v{/ruley X /rulex X V}B /V
{}B /RV statusdict begin /product where{pop product dup length 7 ge{0 7
getinterval dup(Display)eq exch 0 4 getinterval(NeXT)eq or}{pop false}
ifelse}{false}ifelse end{{gsave TR -.1 .1 TR 1 1 scale rulex ruley false
RMat{BDot}imagemask grestore}}{{gsave TR -.1 .1 TR rulex ruley scale 1 1
false RMat{BDot}imagemask grestore}}ifelse B /QV{gsave newpath transform
round exch round exch itransform moveto rulex 0 rlineto 0 ruley neg
rlineto rulex neg 0 rlineto fill grestore}B /a{moveto}B /delta 0 N /tail
{dup /delta X 0 rmoveto}B /M{S p delta add tail}B /b{S p tail}B /c{-4 M}
B /d{-3 M}B /e{-2 M}B /f{-1 M}B /g{0 M}B /h{1 M}B /i{2 M}B /j{3 M}B /k{
4 M}B /w{0 rmoveto}B /l{p -4 w}B /m{p -3 w}B /n{p -2 w}B /o{p -1 w}B /q{
p 1 w}B /r{p 2 w}B /s{p 3 w}B /t{p 4 w}B /x{0 S rmoveto}B /y{3 2 roll p
a}B /bos{/SS save N}B /eos{SS restore}B end
%%EndProcSet
%%BeginFont: Times-Bold
% @@psencodingfile@{
%   author = "S. Rahtz, P. MacKay, Alan Jeffrey, B. Horn, K. Berry",
%   version = "0.6",
%   date = "22 June 1996",
%   filename = "8r.enc",
%   email = "kb@@mail.tug.org",
%   address = "135 Center Hill Rd. // Plymouth, MA 02360",
%   codetable = "ISO/ASCII",
%   checksum = "119     662    4424",
%   docstring = "Encoding for TrueType or Type 1 fonts to be used with TeX."
% @}
% 
% Idea is to have all the characters normally included in Type 1 fonts
% available for typesetting. This is effectively the characters in Adobe
% Standard Encoding + ISO Latin 1 + extra characters from Lucida.
% 
% Character code assignments were made as follows:
% 
% (1) the Windows ANSI characters are almost all in their Windows ANSI
% positions, because some Windows users cannot easily reencode the
% fonts, and it makes no difference on other systems. The only Windows
% ANSI characters not available are those that make no sense for
% typesetting -- rubout (127 decimal), nobreakspace (160), softhyphen
% (173). quotesingle and grave are moved just because it's such an
% irritation not having them in TeX positions.
% 
% (2) Remaining characters are assigned arbitrarily to the lower part
% of the range, avoiding 0, 10 and 13 in case we meet dumb software.
% 
% (3) Y&Y Lucida Bright includes some extra text characters; in the
% hopes that other PostScript fonts, perhaps created for public
% consumption, will include them, they are included starting at 0x12.
% 
% (4) Remaining positions left undefined are for use in (hopefully)
% upward-compatible revisions, if someday more characters are generally
% available.
% 
% (5) hyphen appears twice for compatibility with both ASCII and Windows.
% 
/TeXBase1Encoding [
% 0x00 (encoded characters from Adobe Standard not in Windows 3.1)
  /.notdef /dotaccent /fi /fl
  /fraction /hungarumlaut /Lslash /lslash
  /ogonek /ring /.notdef
  /breve /minus /.notdef 
% These are the only two remaining unencoded characters, so may as
% well include them.
  /Zcaron /zcaron 
% 0x10
 /caron /dotlessi 
% (unusual TeX characters available in, e.g., Lucida Bright)
 /dotlessj /ff /ffi /ffl 
 /.notdef /.notdef /.notdef /.notdef
 /.notdef /.notdef /.notdef /.notdef
 % very contentious; it's so painful not having quoteleft and quoteright
 % at 96 and 145 that we move the things normally found there down to here.
 /grave /quotesingle 
% 0x20 (ASCII begins)
 /space /exclam /quotedbl /numbersign
 /dollar /percent /ampersand /quoteright
 /parenleft /parenright /asterisk /plus /comma /hyphen /period /slash
% 0x30
 /zero /one /two /three /four /five /six /seven
 /eight /nine /colon /semicolon /less /equal /greater /question
% 0x40
 /at /A /B /C /D /E /F /G /H /I /J /K /L /M /N /O
% 0x50
 /P /Q /R /S /T /U /V /W
 /X /Y /Z /bracketleft /backslash /bracketright /asciicircum /underscore
% 0x60
 /quoteleft /a /b /c /d /e /f /g /h /i /j /k /l /m /n /o
% 0x70
 /p /q /r /s /t /u /v /w
 /x /y /z /braceleft /bar /braceright /asciitilde
 /.notdef % rubout; ASCII ends
% 0x80
 /.notdef /.notdef /quotesinglbase /florin
 /quotedblbase /ellipsis /dagger /daggerdbl
 /circumflex /perthousand /Scaron /guilsinglleft
 /OE /.notdef /.notdef /.notdef
% 0x90
 /.notdef /.notdef /.notdef /quotedblleft
 /quotedblright /bullet /endash /emdash
 /tilde /trademark /scaron /guilsinglright
 /oe /.notdef /.notdef /Ydieresis
% 0xA0
 /.notdef % nobreakspace
 /exclamdown /cent /sterling
 /currency /yen /brokenbar /section
 /dieresis /copyright /ordfeminine /guillemotleft
 /logicalnot
 /hyphen % Y&Y (also at 45); Windows' softhyphen
 /registered
 /macron
% 0xD0
 /degree /plusminus /twosuperior /threesuperior
 /acute /mu /paragraph /periodcentered
 /cedilla /onesuperior /ordmasculine /guillemotright
 /onequarter /onehalf /threequarters /questiondown
% 0xC0
 /Agrave /Aacute /Acircumflex /Atilde /Adieresis /Aring /AE /Ccedilla
 /Egrave /Eacute /Ecircumflex /Edieresis
 /Igrave /Iacute /Icircumflex /Idieresis
% 0xD0
 /Eth /Ntilde /Ograve /Oacute
 /Ocircumflex /Otilde /Odieresis /multiply
 /Oslash /Ugrave /Uacute /Ucircumflex
 /Udieresis /Yacute /Thorn /germandbls
% 0xE0
 /agrave /aacute /acircumflex /atilde
 /adieresis /aring /ae /ccedilla
 /egrave /eacute /ecircumflex /edieresis
 /igrave /iacute /icircumflex /idieresis
% 0xF0
 /eth /ntilde /ograve /oacute
 /ocircumflex /otilde /odieresis /divide
 /oslash /ugrave /uacute /ucircumflex
 /udieresis /yacute /thorn /ydieresis
] def
%%EndFont
%%BeginProcSet: texps.pro
TeXDict begin /rf{findfont dup length 1 add dict begin{1 index /FID ne 2
index /UniqueID ne and{def}{pop pop}ifelse}forall[1 index 0 6 -1 roll
exec 0 exch 5 -1 roll VResolution Resolution div mul neg 0 0]/Metrics
exch def dict begin Encoding{exch dup type /integertype ne{pop pop 1 sub
dup 0 le{pop}{[}ifelse}{FontMatrix 0 get div Metrics 0 get div def}
ifelse}forall Metrics /Metrics currentdict end def[2 index currentdict
end definefont 3 -1 roll makefont /setfont load]cvx def}def
/ObliqueSlant{dup sin S cos div neg}B /SlantFont{4 index mul add}def
/ExtendFont{3 -1 roll mul exch}def /ReEncodeFont{/Encoding exch def}def
end
%%EndProcSet
TeXDict begin 40258431 52099146 1000 600 600 (paper.dvi)
@start /Fa 2 16 df<000380000007C0000007C0000007C0000007C0000007C0000007
C0000007C0007803803CFC03807EFE0380FE7F8383FC3FC387F80FE38FE003FBBF8000FF
FE00003FF800000FE000000FE000003FF80000FFFE0003FBBF800FE38FE03FC387F87F83
83FCFE0380FEFC03807E7803803C0007C0000007C0000007C0000007C0000007C0000007
C0000007C000000380001F247BA62A>3 D<000FE000007FFC0000FFFE0003FFFF8007FF
FFC00FFFFFE01FFFFFF03FFFFFF83FFFFFF87FFFFFFC7FFFFFFC7FFFFFFCFFFFFFFEFFFF
FFFEFFFFFFFEFFFFFFFEFFFFFFFEFFFFFFFEFFFFFFFEFFFFFFFE7FFFFFFC7FFFFFFC7FFF
FFFC3FFFFFF83FFFFFF81FFFFFF00FFFFFE007FFFFC003FFFF8000FFFE00007FFC00000F
E0001F207BA42A>15 D E /Fb 103[50 29[50 50 50 50 50 50
50 50 50 1[50 50 50 50 50 50 50 50 50 50 50 50 50 50
50 50 8[50 50 50 50 1[50 2[50 50 50 50 50 2[50 1[50 2[50
50 1[50 6[50 50 3[50 3[50 50 50 50 50 45[{
 TeXBase1Encoding ReEncodeFont }49 83.333336 /Courier
rf /Fc 87[28 17[42 1[37 37 24[37 42 42 60 42 42 23 32
28 42 42 42 42 65 23 42 23 23 42 42 28 37 42 37 42 37
3[28 1[28 51 2[78 60 60 51 46 55 1[46 60 60 74 51 60
32 28 60 60 46 51 60 55 55 60 5[23 23 42 42 42 42 42
42 42 42 42 42 23 21 28 21 47 1[28 28 28 35[46 46 2[{
 TeXBase1Encoding ReEncodeFont }77 83.333336 /Times-Roman
rf /Fd 133[32 37 37 55 37 42 23 32 32 42 42 42 42 60
23 37 23 23 42 42 23 37 42 37 42 42 12[46 1[51 1[51 2[69
3[28 60 2[51 60 55 1[51 18[21 28 21 41[42 2[{
 TeXBase1Encoding ReEncodeFont }40 83.333336 /Times-Italic
rf /Fe 139[33 39 44 14[44 55 50 31[72 65[{
 TeXBase1Encoding ReEncodeFont }7 100.000000 /Times-Bold
rf /Ff 75[33 29[50 28[44 44 1[44 50 28 39 39 50 1[50
50 72 28 2[28 50 50 28 44 50 44 50 50 13[50 2[61 2[83
55 1[44 33 1[72 61 61 72 66 61 1[92 7[50 50 2[50 50 50
50 50 1[25 33 25 44[{ TeXBase1Encoding ReEncodeFont }46
100.000000 /Times-Italic rf /Fg 140[39 33 2[50 50 4[28
3[44 50 2[44 21[72 2[72 72[{ TeXBase1Encoding ReEncodeFont }10
100.000000 /Times-Roman rf /Fh 107[60 60 25[60 1[86 60
66 40 47 53 1[66 60 66 100 33 66 40 33 66 60 40 53 66
53 66 60 12[80 66 86 1[73 93 86 113 1[93 1[47 2[73 2[86
1[86 6[40 60 60 60 60 60 60 60 60 60 60 45[66 2[{
 TeXBase1Encoding ReEncodeFont }49 119.999947 /Times-Bold
rf end
%%EndProlog
%%BeginSetup
%%Feature: *Resolution 600dpi
TeXDict begin
%%PaperSize: Letter

%%EndSetup
%%Page: 1 1
1 0 bop 270 399 a Fh(The)31 b(Molecular)f(Modeling)h(T)-11
b(oolkit:)37 b(a)30 b(case)f(study)h(of)f(a)h(lar)o(ge)g(scienti\002c)
1387 548 y(application)h(in)g(Python)1634 789 y Fg(K)m(onrad)24
b(Hinsen)1141 905 y Ff(Labor)o(atoir)l(e)f(de)i(Dynamique)g(Mol)2412
906 y(\264)2407 905 y(eculair)l(e)929 1021 y(Institut)f(de)h(Biolo)o
(gie)e(Structur)o(ale)g(\226)i(J)n(ean-Pierr)l(e)f(Ebel)1550
1137 y(41,)h(av)-7 b(.)30 b(des)25 b(Martyr)o(s)1273
1254 y(38027)f(Gr)l(enoble)h(Cede)n(x)g(1,)g(F)-5 b(r)o(ance)1655
1370 y(hinsen@ibs.fr)0 1695 y Fe(Abstract)0 1867 y Fd(The)27
b(Molecular)f(Modeling)f(T)-8 b(oolkit)27 b(is)h(a)e(libr)o(ary)h(of)g
(Python)0 1966 y(modules)45 b(and)f(C)i(e)n(xtension)f(modules)g(that)g
(pr)l(o)o(vides)g(an)0 2066 y(object-oriented)37 b(description)i(of)g
(molecular)g(systems)h(and)0 2166 y(an)25 b(implementation)f(of)h(the)h
(most)g(common)e(modeling)g(tec)o(h-)0 2265 y(niques.)70
b(It)36 b(is)g(one)f(of)g(the)h(\002r)o(st)g(lar)m(g)o(e)f
(scienti\002c)g(applica-)0 2365 y(tions)20 b(implemented)f(in)h
(Python.)k(This)d(article)f(pr)m(esents)g(some)0 2465
y(aspects)28 b(of)f(its)i(design)e(and)g(implementation)f(that)h(ar)m
(e)h(typi-)0 2564 y(cal)h(for)h(scienti\002c)f(applications)e(in)j(g)o
(ener)o(al.)51 b(Its)30 b(aim)f(is)h(to)0 2664 y(demonstr)o(ate)g(by)i
(e)n(xample)f(how)h(scienti\002c)f(computing)f(can)0
2763 y(bene\002t)16 b(fr)l(om)j(Python,)d(and)h(to)g(show)h(how)f
(common)g(pr)l(oblems)0 2863 y(can)j(be)g(solved.)0 3189
y Fh(1)119 b(Intr)n(oduction)0 3391 y Fc(Scienti\002c)23
b(computing)e(is)j(inherently)e(e)o(xperimental)f(and)h(e)o(x-)0
3490 y(ploratory)-5 b(.)27 b(Although)20 b(a)i(lar)o(ge)e(number)g(of)h
(established)g(algo-)0 3590 y(rithms)e(and)g(techniques)f(are)h(used)h
(again)e(and)h(again,)f(the)i(spe-)0 3690 y(ci\002c)f(combination)d(of)
i(techniques)f(needed)f(to)j(solv)o(e)f(a)g(partic-)0
3789 y(ular)k(problem)f(is)i(usually)f(unique)f(and)g(not)h(precisely)g
(kno)n(wn)0 3889 y(at)f(the)f(start)h(of)f(a)g(project.)0
3997 y(T)-7 b(ypically)i(,)16 b(a)h(scientist)g(using)f(computational)e
(techniques)h(has)0 4096 y(a)i(collection)f(of)g(v)n(arious)g(programs)
f(that)i(deal)f(with)h(some)g(part)0 4196 y(of)32 b(the)h(problem)d(at)
j(hand.)61 b(Some)32 b(of)g(these)h(programs)e(are)0
4296 y(widely)22 b(used)h(and)f(come)g(with)h(documentation)d(and)i
(perhaps)0 4395 y(e)n(v)o(en)27 b(technical)g(support.)48
b(Others)28 b(ha)n(v)o(e)f(been)h(written)f(by)h(a)0
4495 y(student)h(\226)h(who)f(has)h(graduated)d(long)i(ago)g(\226)g
(for)g(a)h(speci\002c)0 4595 y(task,)k(and)d(their)g(suitability)g(and)
g(reliability)f(may)h(be)g(ques-)0 4694 y(tionable.)64
b(All)35 b(these)f(programs)d(ha)n(v)o(e)j(their)f(o)n(wn)g(con)m(v)o
(en-)0 4794 y(tions,)26 b(input)f(and)g(output)f(\002le)i(formats,)f
(and)g(idiosyncrasies.)0 4894 y(In)f(practice,)h(computational)d
(scientists)j(spend)f(a)h(signi\002cant)0 4993 y(amount)30
b(of)h(time)g(with)h(\002nding)e(and)h(testing)g(the)g(programs)0
5093 y(the)o(y)21 b(need)g(and)g(dealing)g(with)h(\002le)h(con)m(v)o
(ersion)c(and)i(other)g(in-)0 5192 y(terf)o(acing)e(problems.)0
5300 y(The)27 b(combination)f(of)h(the)h(indi)n(vidual)e(computational)
f(steps)0 5400 y(occurs)44 b(manually)f(\(interacti)n(v)o(ely\))g(or)h
(with)h(simple)g(shell)2010 1695 y(scripts.)51 b(Some)28
b(of)g(the)h(programs)e(used)h(may)h(ha)n(v)o(e)f(a)h(b)n(uilt-)2010
1795 y(in)d(scripting)f(language,)g(b)n(ut)h(these)f(scripting)g
(languages)g(are)2010 1895 y(ne)n(v)o(er)31 b(suf)n(\002cient)h(to)g
(deal)g(with)h(all)f(aspects)h(of)f(a)h(problem,)2010
1994 y(and)25 b(the)o(y)g(certainly)g(do)g(not)h(allo)n(w)f(the)h(inte)
o(gration)e(of)h(other)2010 2094 y(independently)19 b(written)j
(programs.)30 b(Sometimes)22 b(there)g(is)h(no)2010 2193
y(other)j(w)o(ay)h(left)g(than)g(to)g(write)g(a)g(specialized)f
(program)f(in)i(a)2010 2293 y(\223real\224)20 b(programming)d
(language,)h(in)i(practice)g(F)o(ortran)f(or)h(C.)2010
2398 y(Another)31 b(problem)f(with)i(scienti\002c)h(programs)d(is)j
(that)f(the)o(y)2010 2498 y(lack)20 b(e)n(v)o(en)f(the)h(most)h
(elementary)d(elements)i(of)g(user)n(-friendly)2010 2597
y(design.)52 b(This)30 b(is)g(partly)f(due)g(to)h(lack)f(of)g(a)o(w)o
(areness)g(of)h(the)2010 2697 y(problem;)17 b(man)o(y)f(scientists)i
(ha)n(v)o(e)f(ne)n(v)o(er)f(seen)h(a)h(user)n(-friendly)2010
2797 y(program.)k(Also,)17 b(most)g(programs)e(are)h(quite)h(old,)f
(dating)g(back)2010 2896 y(to)21 b(the)f(mainframe)f(or)i(e)n(v)o(en)e
(the)i(punched-card)c(era.)26 b(In)20 b(addi-)2010 2996
y(tion,)j(the)f(predominant)e(scienti\002c)j(programming)d(language,)
2010 3095 y(F)o(ortran-77,)26 b(mak)o(es)h(user)n(-friendly)f
(programming)d(dif)n(\002cult,)2010 3195 y(if)d(not)f(impossible.)24
b(F)o(or)19 b(e)o(xample,)f(binary)g(\002les)i(produced)d(by)2010
3295 y(a)23 b(F)o(ortran)f(program)f(are)i(inherently)e(machine)g(and)i
(compiler)2010 3394 y(dependent,)f(which)h(mak)o(es)g(data)g(e)o
(xchange)e(dif)n(\002cult)i(e)n(v)o(en)f(if)2010 3494
y(e)n(v)o(eryone)c(uses)i(the)h(same)f(programs.)2010
3599 y(This)25 b(article)g(will)h(sho)n(w)e(ho)n(w)h(Python)f(can)g
(help)h(to)g(impro)o(v)o(e)2010 3699 y(this)i(situation.)42
b(The)25 b(e)o(xample)g(presented,)h(molecular)f(mod-)2010
3798 y(eling,)32 b(is)f(not)f(an)g(untypical)f(scienti\002c)h
(application.)54 b(Man)o(y)2010 3898 y(of)20 b(the)g(design)f
(decisions)h(and)g(techniques)e(can)i(be)g(applied)f(to)2010
3998 y(other)h(scienti\002c)h(domains.)k(The)20 b(library)f(described)h
(here,)g(the)2010 4097 y(Molecular)k(Modeling)g(T)-7
b(oolkit)25 b(\(from)g(no)n(w)g(on)g(MMTK\),)g(is)2010
4197 y(freely)19 b(a)n(v)n(ailable)h([MMTK)o(].)2010
4507 y Fh(2)119 b(Molecular)31 b(Modeling)2010 4703 y
Fc(The)j(term)h Fd(molecular)f(modeling)f Fc(is)j(used)f(to)g(describe)
f(the)2010 4802 y(study)j(of)g(molecules)f(and)h(molecular)e(systems)j
(by)f(means)2010 4902 y(of)32 b(computer)f(models.)61
b(The)32 b(most)h(common)e(model)g(for)h(a)2010 5001
y(molecule)25 b(consists)h(of)g(a)g(set)h(of)f(atoms,)h(considered)d
(to)i(be)g(a)2010 5101 y(point)18 b(mass)i(ha)n(ving)e(a)i(position)f
(in)g(space)g(and)g(possibly)f(other)2010 5201 y(properties.)29
b(All)22 b(the)g(atoms)g(in)g(a)g(molecular)f(system)h(interact)2010
5300 y(with)j(each)f(other;)j(these)d(interactions)g(are)h(described)e
(by)i(the)2010 5400 y Fd(inter)o(action)f(ener)m(gy)p
Fc(,)i(which)g(is)g(a)g(function)e(of)h(the)h(positions)p
eop
%%Page: 2 2
2 1 bop 0 83 a Fc(and)15 b(properties)f(of)h(the)h(atoms.)23
b(The)15 b(interaction)g(ener)o(gy)e(is)k(the)0 183 y(central)28
b(quantity)g(in)h(molecular)f(modeling,)h(and)f(construct-)0
282 y(ing)33 b(an)f(appropriate)f(function)g(is)j(one)e(of)h(the)g
(major)f(prob-)0 382 y(lems.)46 b(There)27 b(are)g(man)o(y)f
(\223recipes\224)g(for)h(calculating)f(the)h(in-)0 482
y(teraction)22 b(ener)o(gy)-5 b(,)22 b(ranging)g(from)g(v)o(ery)g
(simple)i(functions)e(of)0 581 y(interatomic)g(distances)h(to)h(the)f
(solution)g(of)g(the)g(Schr)7 b(\250)-35 b(odinger)0
681 y(equation)14 b(\(the)i(fundamental)d(equation)i(of)g(quantum)f
(mechan-)0 780 y(ics\))27 b(for)g(all)g(electrons)g(of)f(all)i(atoms)f
(in)g(the)g(system.)46 b(These)0 880 y(recipes)20 b(are)g(called)g
Fd(for)m(ce)g(\002elds)p Fc(.)0 986 y(Lik)o(e)g(man)o(y)f(other)h
(scienti\002c)h(applications,)e(molecular)g(mod-)0 1086
y(eling)27 b(relies)g(hea)n(vily)f(on)h(a)g(fe)n(w)g(computationally)e
(intensi)n(v)o(e)0 1186 y(algorithms.)74 b(An)37 b(e)o(xample)f(is)i
Fd(ener)m(gy)e(minimization)p Fc(,)41 b(i.e.)0 1285 y(\002nding)21
b(a)h(con\002guration)d(of)i(atoms)h(that)g(is)g(a)g(local)g(or)f
(global)0 1385 y(minimum)28 b(of)h(the)h(\(high-dimensional\))25
b(interaction)k(ener)o(gy)0 1484 y(function;)36 b(this)d(operation)d
(can)i(tak)o(e)g(se)n(v)o(eral)g(days)g(or)g(e)n(v)o(en)0
1584 y(weeks)21 b(of)f(CPU)i(time)f(for)f(lar)o(ge)g(systems.)28
b(Another)19 b(e)o(xample)0 1684 y(is)k Fd(normal)f(mode)g(analysis)p
Fc(,)h(which)f(essentially)g(in)m(v)n(olv)o(es)g(the)0
1783 y(calculation)d(of)h(the)h(matrix)f(of)g(second)f(deri)n(v)n(ati)n
(v)o(es)g(of)h(the)h(in-)0 1883 y(teraction)e(ener)o(gy)g(function)f
(and)i(the)g(diagonalization)e(of)i(this)0 1983 y(matrix.)k(Ev)o(en)19
b(calculating)g(the)h(interaction)f(ener)o(gy)f(itself)j(re-)0
2082 y(quires)26 b(a)h(substantial)f(amount)f(of)h(CPU)h(time)g(for)f
(lar)o(ge)f(sys-)0 2182 y(tems.)0 2288 y(Ho)n(we)n(v)o(er)m(,)33
b(modelers)d(spend)h(most)h(of)g(their)f(time)h(on)f(other)0
2388 y(operations,)25 b(which)f(are)i(to)f(a)h(high)e(de)o(gree)g
(interacti)n(v)o(e.)39 b(The)0 2487 y(\002rst)26 b(important)d(step)i
(is)h(the)f(de\002nition)f(of)g(the)h(system)h(to)f(be)0
2587 y(studied,)35 b(i.e.)64 b(deciding)31 b(which)h(molecules)g
(should)g(partic-)0 2687 y(ipate,)j(what)e(a)g(reasonable)e
(con\002guration)f(looks)i(lik)o(e,)j(and)0 2786 y(which)26
b(force)h(\002eld)g(should)f(be)h(used.)45 b(Then)26
b(an)h(appropriate)0 2886 y(technique)j(for)i(obtaining)e(the)i
(required)e(information)g(must)0 2985 y(be)g(selected)g(or)g(de)n(v)o
(eloped.)51 b(All)31 b(this)f(requires)f(a)i(lar)o(ge)e(set)0
3085 y(of)41 b(fundamental)f(operations:)66 b(reading)40
b(in)i(e)o(xternal)e(\(e.g.)0 3185 y(e)o(xperimental\))32
b(data,)37 b(calculating,)g(comparing,)e(and)f(mod-)0
3284 y(ifying)d(geometrical)f(quantities,)k(visualization,)f(modifying)
0 3384 y(force)d(\002elds,)35 b(ener)o(gy)29 b(minimization,)k(etc.)58
b(The)31 b(fe)n(w)h(time-)0 3484 y(consuming)17 b(operations)h
(mentioned)f(abo)o(v)o(e)h(are)h(in)g(f)o(act)h(noth-)0
3583 y(ing)c(special,)h(the)o(y)f(only)g(tak)o(e)h(longer)e(to)i
(complete.)22 b(Ne)n(v)o(erthe-)0 3683 y(less,)e(traditional)e
(modeling)g(programs)f(are)i(designed)f(around)0 3782
y(these)30 b(fe)n(w)f(operations,)h(ignoring)e(the)i(others)f
(altogether)f(or)0 3882 y(implementing)18 b(them)i(as)h(an)f
(afterthought.)0 3988 y(It)36 b(should)f(also)h(be)g(mentioned)e(that)i
(molecular)e(modeling)0 4088 y(is)28 b(f)o(ar)f(from)g(a)g(mature)g
(discipline.)45 b(Although)26 b(some)h(gener)n(-)0 4188
y(ally)20 b(accepted)e(techniques)g(e)o(xist,)i(the)o(y)f(are)g(not)g
(suf)n(\002cient)g(for)0 4287 y(studying)29 b(man)o(y)h(of)g(the)h(lar)
o(ge)e(systems)j(that)e(are)h(of)f(practi-)0 4387 y(cal)g(rele)n(v)n
(ance.)50 b(Ne)n(w)30 b(methods)e(and)g(techniques)g(are)i(being)0
4487 y(de)n(v)o(eloped)20 b(continuously)-5 b(.)31 b(Therefore)21
b(molecular)g(modeling)0 4586 y(softw)o(are)c(ought)e(to)j(be)f
(designed)f(for)g(e)o(xtensibility)-5 b(,)16 b(b)n(ut)h(tradi-)0
4686 y(tional)23 b(packages)f(ha)n(v)o(e)h(pro)o(v)o(ed)e(to)j(be)f
(unsatisf)o(actory)f(in)i(this)0 4785 y(respect.)0 5102
y Fh(3)119 b(Ov)o(er)o(view)30 b(of)g(MMTK)0 5300 y Fc(Most)d
(molecular)e(modeling)g(programs)g(are)h(written)g(around)0
5400 y(the)21 b(fe)n(w)g(time-consuming)d(algorithms)i(and)g(adapt)h
(their)g(data)2010 83 y(models)26 b(to)h(them.)43 b(A)27
b(typical)f(representation)f(of)h(a)h(molecu-)2010 183
y(lar)f(system)f(is)i(a)f(list)h(of)e(atoms)g(plus)h(an)f(implicit)h
(force)e(\002eld)2010 282 y(\(fe)n(w)31 b(programs)g(can)g(handle)g
(more)g(than)h(one)f(force)g(\002eld\).)2010 382 y(The)15
b(molecular)g(structure)g(disappears,)g(although)f(it)j(w)o(ould)e(be)
2010 482 y(v)o(ery)24 b(useful)g(for)h(the)g(user)-5
b(.)40 b(Instead)24 b(of)h(referring)e(to,)j(for)e(e)o(x-)2010
581 y(ample,)i(\223the)g(side)g(chain)g(of)f(histidine-34)f(in)i(the)g
(re)o(gulatory)2010 681 y(chain\224)19 b(\(a)g(v)o(ery)f(meaningful)f
(description)h(for)h(a)g(biochemist\),)2010 780 y(you)27
b(might)g(ha)n(v)o(e)f(to)i(say)g(\223the)f(atoms)h(in)f(group)f(270)h
(whose)2010 880 y(names)20 b(are)g(not)g(C,)h(N,)f(O)h(or)f(H\224.)2010
989 y(In)28 b(contrast,)i(MMTK)e(is)i(based)e(on)g(an)g
(object-oriented)e(de-)2010 1088 y(scription)31 b(of)h(molecular)e
(systems,)35 b(with)d(classes)h(matching)2010 1188 y(the)d(real)f
(objects)g(that)h(chemists)g(talk)f(about:)43 b(atoms,)32
b(func-)2010 1288 y(tional)g(groups,)i(molecules,)g(and)e(comple)o(x)o
(es.)59 b(In)32 b(addition)2010 1387 y(there)25 b(are)h(object)g(types)
g(describing)e(force)h(\002elds,)j(uni)n(v)o(erses)2010
1487 y(\(the)21 b(\223en)m(vironments\224)d(of)j(molecular)e
(systems\),)j(\223machines\224)2010 1587 y(acting)27
b(on)g(a)g(uni)n(v)o(erse)f(\(e.g.)46 b(ener)o(gy)25
b(minimizers\),)j(and)f(the)2010 1686 y(results)e(of)g(some)f
(operations)f(\(dynamical)g(trajectories,)i(nor)n(-)2010
1786 y(mal)j(modes)g(etc.\).)48 b(Most)29 b(of)e(these)i(objects)f(are)
g(f)o(amiliar)f(to)2010 1885 y(chemists,)g(and)e(ne)n(w)g(users)h(ha)n
(v)o(e)f(no)g(problems)f(understand-)2010 1985 y(ing)16
b(them,)h(although)e(it)i(tak)o(es)g(a)g(while)g(to)g(get)f(rid)h(of)f
(old)h(habits)2010 2085 y(and)j(use)g(the)g(object-oriented)e
(description)g(ef)n(\002ciently)-5 b(.)2010 2194 y(As)32
b(the)f(name)f(implies,)k(MMTK)d(is)h(not)e(a)i(program,)f(b)n(ut)g(a)
2010 2293 y(library)-5 b(.)62 b(It)33 b(does)g(not)f(embed)g(Python)g
(as)h(a)h(scripting)e(lan-)2010 2393 y(guage,)26 b(b)n(ut)g(e)o(xtends)
f(Python)g(with)h(ne)n(w)g(modules.)42 b(MMTK)2010 2492
y(users)17 b(ha)n(v)o(e)f(the)g(freedom)f(to)h(choose)g(and)g(combine)f
(what)h(the)o(y)2010 2592 y(need)28 b(from)g(MMTK)h(and)g(from)f(other)
g(libraries.)51 b(This)29 b(per)n(-)2010 2692 y(mits)18
b(e)o(xplorati)n(v)o(e)e(w)o(ork)h(in)g(a)i(w)o(ay)e(that)h(with)g
(traditional)f(tools)2010 2791 y(w)o(ould)23 b(be)g(prohibiti)n(v)o
(ely)e(complicated.)32 b(F)o(or)23 b(e)o(xample,)g(non-)2010
2891 y(standard)29 b(visualization)g(tasks)i(can)f(be)g(handled)f(by)g
(a)i(short)2010 2991 y(Python)e(program)f(using)i(MMTK,)g(a)g(VRML)h
(module,)g(and)2010 3090 y(an)18 b(e)o(xternal)f(VRML)h(vie)n(wer)-5
b(.)24 b(W)m(ith)19 b(traditional)e(tools,)h(the)g(ef-)2010
3190 y(fort)h(to)g(e)o(xtract)g(and)g(con)m(v)o(ert)e(the)j(data)f(w)o
(ould)g(be)g(prohibiti)n(v)o(e.)2010 3299 y(The)31 b(idea)h(of)f(b)n
(uilding)f(scienti\002c)i(code)f(in)h(the)f(form)g(of)g(li-)2010
3398 y(braries)37 b(that)h(are)f(tied)h(together)e(by)h(an)h
(interpreter)d(is)k(not)2010 3498 y(ne)n(w)-5 b(.)50
b(The)28 b(Basis)i(Code)f(De)n(v)o(elopment)d(System)j(de)n(v)o(eloped)
2010 3598 y(at)24 b(LLNL)f([Basis)q(],)h(for)e(e)o(xample,)h(pro)o
(vides)f(a)h(scripting)g(lan-)2010 3697 y(guage)k(e)o(xtendable)f(in)i
(F)o(ortran,)h(and)e(Tcl)i(has)f(been)g(used)f(in)2010
3797 y(some)22 b(scienti\002c)g(applications.)29 b(Ho)n(we)n(v)o(er)m
(,)20 b(such)i(approaches)2010 3896 y(ne)n(v)o(er)29
b(recei)n(v)o(ed)g(the)i(attention)f(the)o(y)g(deserv)o(ed,)h(and)f
(script-)2010 3996 y(ing)20 b(languages)e(are)i(by)g(design)f(limited)h
(in)g(scope.)25 b(Python,)18 b(in)2010 4096 y(contrast,)25
b(is)h(po)n(werful)d(enough)g(to)i(be)f(used)h(for)f(most)h(of)g(the)
2010 4195 y(library)19 b(itself.)2010 4304 y(MMTK)29
b(is)i(a)f(rather)e(lar)o(ge)h(library)-5 b(,)30 b(consisting)f(\(in)g
(v)o(ersion)2010 4404 y(1.0b2\))g(of)i(36)f(Python)g(modules)g(and)g
(four)g(C)i(modules.)56 b(It)2010 4503 y(w)o(ould)30
b(be)h(v)o(ery)f(dif)n(\002cult)g(for)g(users)h(to)g(remember)e(what)i
(is)2010 4603 y(de\002ned)26 b(in)h(which)f(module,)h(especially)f
(since)h(the)g(modules)2010 4703 y(de\002ne)h(man)o(y)e(functions)h
(and)g(classes)j(for)d(internal)g(use)h(that)2010 4802
y(are)h(not)g(of)g(direct)f(utility)h(to)h(the)f(MMTK)g(user)-5
b(.)52 b(Therefore)2010 4902 y(MMTK)36 b(contains)f(one)g(more)g
(module)g(which)g(does)h(noth-)2010 5001 y(ing)24 b(b)n(ut)h(import)f
(all)h(the)g(user)n(-rele)n(v)n(ant)e(de\002nitions)h(from)g(the)2010
5101 y(other)d(modules.)27 b(T)-7 b(o)22 b(the)f(user)m(,)g(MMTK)g
(appears)g(thus)g(as)h(one)2010 5201 y(module.)54 b(The)30
b(disadv)n(antage)f(of)h(this)h(approach)d(is)j(that)g(all)2010
5300 y(modules)g(are)h(loaded)f(when)g(the)h(\223master\224)f(module)g
(is)i(im-)2010 5400 y(ported,)25 b(e)n(v)o(en)f(if)h(the)o(y)f(are)h
(not)g(needed.)38 b(As)26 b(MMTK)e(gro)n(ws,)p eop
%%Page: 3 3
3 2 bop 0 83 a Fc(it)31 b(might)e(become)g(necessary)h(to)g(introduce)e
(some)i(more)g(of)0 183 y(these)20 b(\223meta-modules\224.)0
288 y(In)h(summary)-5 b(,)19 b(the)j(implementation)d(of)i(MMTK)g(as)h
(a)g(Python)0 387 y(library)29 b(of)n(fers)g(tw)o(o)i(essential)f(adv)n
(antages)f(o)o(v)o(er)g(traditional)0 487 y(modeling)17
b(programs:)23 b(an)c(object-oriented)d(description)h(fully)0
587 y(accessible)25 b(to)h(the)f(end)g(user)m(,)g(and)g(the)g(freedom)f
(to)h(combine)0 686 y(MMTK)33 b(with)h(other)e(libraries.)64
b(Other)33 b(scienti\002c)h(applica-)0 786 y(tions)20
b(w)o(ould)g(equally)f(bene\002t)h(from)f(this)h(approach.)0
1097 y Fh(4)119 b(The)31 b(\223chemical)f(object\224)f(classes)0
1293 y Fc(The)h(central)g(part)h(of)f(MMTK)g(\226)h(and)f(the)h(part)f
(in)h(which)f(it)0 1393 y(of)n(fers)17 b(the)h(most)g(adv)n(antages)f
(compared)f(to)i(traditional)f(mod-)0 1492 y(eling)28
b(programs)f(\226)h(is)i(the)e(representation)e(of)j(chemical)e(ob-)0
1592 y(jects)d(\(atoms,)f(molecules,)g(etc.\))35 b(and)22
b(complete)g(systems.)35 b(A)0 1692 y(common)16 b(base)i(class,)h
Fb(GroupOfAtoms)p Fc(,)d(de\002nes)i(the)f(oper)n(-)0
1791 y(ations)22 b(that)h(are)f(de\002ned)f(solely)i(in)f(terms)g(of)g
(atomic)g(proper)n(-)0 1891 y(ties)k(and)e(positions.)39
b(This)25 b(includes)f(all)i(geometrical)d(opera-)0 1990
y(tions)f(\(\002nding)e(the)i(center)f(of)h(mass)h(and)e(moment)g(of)g
(inertia,)0 2090 y(mo)o(ving)15 b(the)j(object)f(in)g(se)n(v)o(eral)g
(w)o(ays,)h(superposing)d(tw)o(o)i(con-)0 2190 y(\002gurations,)i
(etc.\),)g(b)n(ut)i(also)f(visualization.)0 2295 y(A)d(subclass)g(is)g
Fb(ChemicalObject)p Fc(,)e(which)h(in)g(turn)g(has)h(the)0
2394 y(subclasses)f Fb(Atom)f Fc(and)f Fb(CompositeChemicalObject)p
Fc(.)0 2494 y(The)26 b(latter)h(has)g(the)f(subclasses)i
Fb(Group)p Fc(,)f Fb(Molecule)p Fc(,)g(and)0 2594 y Fb(Complex)p
Fc(.)108 b(Comple)o(x)o(es)46 b(can)i(contain)f(molecules)g(and)0
2693 y(atoms,)34 b(molecules)c(can)h(contains)f(groups)g(and)h(atoms,)i
(and)0 2793 y(groups)28 b(can)i(also)g(contain)f(groups)f(and)h(atoms,)
j(b)n(ut)e(groups)0 2893 y(cannot)19 b(be)h(used)g(outside)g(molecule)f
(de\002nitions.)0 2998 y(Other)138 b(subclasses)h(of)g
Fb(GroupOfAtoms)e Fc(are)0 3097 y Fb(Collection)p Fc(,)38
b(representing)c(an)o(y)g(collection)h(of)g(chemi-)0
3197 y(cal)g(objects,)i(and)d Fb(Universe)p Fc(,)j(representing)32
b(a)j(complete)0 3297 y(system)24 b(with)h(a)f(force)f(\002eld)h(and)g
(perhaps)f(an)h(outer)f(en)m(viron-)0 3396 y(ment.)0
3502 y(A)c(less)h(ob)o(vious)d(choice)h(is)h(ho)n(w)f(to)h(represent)f
(dif)n(ferent)f(types)0 3601 y(of)24 b(molecules,)h(for)f(e)o(xample)f
(w)o(ater)i(molecules)e(and)h(chloro-)0 3701 y(form)g(molecules.)39
b(Molecules)25 b(dif)n(fer)f(only)g(in)h(their)g(compo-)0
3800 y(sition,)19 b(not)h(in)f(the)h(operations)e(de\002ned)g(for)h
(them.)24 b(One)c(could)0 3900 y(de\002ne)i(a)h(subclass)f(for)g(each)g
(molecule,)f(rede\002ning)g(only)h(the)0 4000 y(initialization)27
b(method.)48 b(But)28 b(molecules)g(can)g(change)e(iden-)0
4099 y(tity)j(during)d(chemical)i(reactions,)h(whereas)e(class)j
(instances)0 4199 y(cannot)20 b(change)g(their)h(class.)30
b(Therefore)19 b(all)j(molecules)f(must)0 4299 y(be)f(instances)g(of)g
(the)g(same)h(class.)0 4404 y(MMTK)41 b(implements)g(a)h
(prototype-based)37 b(molecule)k(f)o(ac-)0 4503 y(tory)-5
b(.)24 b(It)d(maintains)f(a)h(database)e(of)h(atom)g(types,)g(group)f
(types,)0 4603 y(molecule)25 b(types,)h(and)f(comple)o(x)f(types.)42
b(Each)25 b(database)g(en-)0 4703 y(try)g(is)i(an)e(object)g(with)g(a)h
(structure)f(almost)g(identical)g(to)g(that)0 4802 y(of)36
b(the)h(ultimate)g(chemical)f(object)g(instance.)74 b(Creating)36
b(a)0 4902 y(real)30 b(instance)g(in)m(v)n(olv)o(es)g(a)g(procedure)e
(similar)j(to)f(that)h(used)0 5001 y(in)21 b(Python')-5
b(s)20 b(cop)o(y)f(module:)25 b(the)20 b(attrib)n(utes)h(of)f(the)h
(prototype)0 5101 y(are)16 b(e)o(xamined)e(and)i(analogous)e(attrib)n
(utes)i(in)h(the)f(instance)g(are)0 5201 y(created.)42
b(Attrib)n(utes)26 b(that)h(are)f(identical)f(for)h(each)g(molecule)0
5300 y(of)31 b(a)h(certain)f(kind)g(\(e.g.)58 b(force)30
b(\002eld)i(parameters\))e(are)h(not)0 5400 y(copied,)19
b(b)n(ut)h(referenced)e(from)h(the)h(ne)n(w)g(instance.)2010
83 y(The)j(disadv)n(antage)d(of)j(this)h(system)f(is)h(that)f(the)f
(instantiation)2010 183 y(procedure)17 b(is)k(slo)n(w)-5
b(,)20 b(ha)n(ving)f(to)h(e)o(xamine)e(all)j(attrib)n(utes)f(again)2010
282 y(each)i(time)h(an)g(instance)g(is)g(created.)32
b(It)23 b(is)h(not)e(uncommon)e(to)2010 382 y(create)f(thousands)f(of)h
(molecules)g(of)g(the)h(same)f(kind)g(in)g(a)h(sys-)2010
482 y(tem,)e(so)f(ef)n(\002cienc)o(y)f(matters.)24 b(It)17
b(is)h(planned)e(to)h(replace)g(the)g(in-)2010 581 y(stantiation)k
(system)g(in)h(the)f(future)f(by)h(a)h(compiled-code)c(v)o(er)n(-)2010
681 y(sion:)33 b(when)23 b(a)i(prototype)c(is)k(instantiated)f(for)f
(the)h(\002rst)h(time,)2010 780 y(it)20 b(creates)g(a)g(custom)e
(instantiation)h(function)f(as)i(a)g(te)o(xt)f(string,)2010
880 y(compiles)c(it)h(using)f(the)h Fb(exec)f Fc(function,)g(and)f
(stores)i(the)g(func-)2010 980 y(tion)23 b(object)f(for)g(later)i(use.)
33 b(Such)23 b(a)g(technique,)f(which)g(relies)2010 1079
y(on)i(the)h(dynamic)f(nature)f(of)i(Python,)g(may)f(be)h(applicable)e
(to)2010 1179 y(prototype-based)17 b(object)i(f)o(actories)h(in)g
(general.)2010 1279 y(The)36 b(database)g(is)h(not)f(part)g(of)g(the)g
(MMTK)g(source)f(code,)2010 1378 y(since)25 b(it)g(must)f(frequently)f
(be)h(e)o(xtended)f(by)h(end)g(users,)h(who)2010 1478
y(should)g(not)h(ha)n(v)o(e)f(to)h(understand)e(the)i(instantiation)g
(system.)2010 1578 y(Instead,)19 b(users)g(write)h(each)f(de\002nition)
f(as)j(a)f(separate)f(te)o(xt)g(\002le)2010 1677 y(and)h(place)f(it)i
(in)g(a)f(directory)f(which)g(is)i(searched)e(by)h(MMTK.)2010
1777 y(The)d(de\002nition)g(\002les)i(are)f(tin)o(y)f(Python)g
(programs)f(that)h(are)h(e)o(x-)2010 1877 y(ecuted)26
b(with)h(the)f Fb(execfile)g Fc(command)f(in)i(a)g(conte)o(xt)e(de-)
2010 1976 y(\002ned)20 b(by)h(a)g(special)g(Python)f(module.)25
b(In)c(addition)e(to)i(the)g(ob-)2010 2076 y(vious)c(adv)n(antage)f(of)
i(not)f(requiring)f(a)i(special)g(parser)m(,)f(the)h(use)2010
2175 y(of)h(tin)o(y)f(Python)g(programs)f(for)h(de\002nition)g(and)g
(con\002guration)2010 2275 y(\002les)k(mak)o(es)e(life)h(easier)f(for)g
(the)h(user)m(,)f(who)g(does)g(not)g(ha)n(v)o(e)g(to)2010
2375 y(remember)e(another)h(syntax.)2010 2474 y(Finally)54
b(it)h(should)e(be)i(mentioned)d(that)i(the)h(prototype)2010
2574 y(database)15 b(is)i(not)e(the)h(only)f(w)o(ay)h(to)g(create)g
(chemical)f(objects)g(in)2010 2674 y(MMTK.)i(F)o(or)h(chain)f
(molecules)g(lik)o(e)i(proteins,)e(whose)g(b)n(uild-)2010
2773 y(ing)28 b(blocks)h(are)f(a)i(small)f(number)e(of)i(functional)e
(groups,)i(it)2010 2873 y(w)o(ould)c(be)h(too)f(much)g(of)h(an)g(ef)n
(fort)e(to)i(write)g(a)h(database)e(en-)2010 2973 y(try)36
b(whose)g(structure)g(w)o(ould)f(be)i(the)f(same)g(for)g(all)h(cases.)
2010 3072 y(Such)22 b(molecules)g(are)h(described)f(by)g(specialized)g
(subclasses)2010 3172 y(that)17 b(de\002ne)f(appropriate)e
(constructors)h(and)h(implement)f(addi-)2010 3271 y(tional)23
b(operations)e(that)i(w)o(ould)f(not)h(mak)o(e)f(sense)h(for)g(general)
2010 3371 y(molecules.)2010 3652 y Fh(5)119 b(Numerically)26
b(intensi)o(v)o(e)f(algorithms)2010 3838 y Fc(It)36 b(w)o(as)h
(mentioned)d(earlier)i(that)g(molecular)f(modeling)f(re-)2010
3938 y(quires)21 b(a)h(fe)n(w)f(computationally)e(e)o(xpensi)n(v)o(e)g
(operations.)27 b(Not)2010 4038 y(all)f(of)f(these)h(operations)d(are)j
(of)f(the)g(\223simple-operation-on-)2010 4137 y(lar)o(ge-dataset\224)
19 b(type,)i(so)g(the)o(y)g(cannot)f(be)h(implemented)e(ef)n(\002-)2010
4237 y(ciently)i(in)g(terms)h(of)f(the)g(array)g(operations)e(from)i
(the)g(numer)n(-)2010 4337 y(ics)i(e)o(xtension)f(\(aka)g(NumPy\))f
([NumPy)o(].)32 b(The)o(y)22 b(must)g(there-)2010 4436
y(fore)d(be)i(implemented)d(in)i(C)h(modules.)2010 4536
y(Ho)n(we)n(v)o(er)m(,)i(a)i(C)h(module)d(dealing)g(with)i(instances)f
(of)h(Python)2010 4636 y(classes)h(is)g(hardly)e(f)o(aster)i(than)e
(Python)g(code)h(itself.)40 b(A)26 b(lo)n(w-)2010 4735
y(le)n(v)o(el)k(representation)e(of)i(the)g(data)g(\(chemical)f
(objects)h(etc.\))2010 4835 y(is)e(therefore)d(necessary)-5
b(.)45 b(This)28 b(lo)n(w-le)n(v)o(el)e(representation)f(is)2010
4934 y(subject)20 b(to)g(tw)o(o)h(conditions:)2135 5101
y Fa(\017)41 b Fc(The)22 b(ef)n(\002cienc)o(y)f(of)h(the)h(C)g(code)f
(must)h(ha)n(v)o(e)e(top)i(prior)n(-)2218 5201 y(ity)-5
b(.)39 b(Some)25 b(of)g(the)g(data)g(\(e.g.)39 b(the)25
b(atomic)g(con\002gura-)2218 5300 y(tion\))e(is)i(accessed)f(v)o(ery)f
(frequently)-5 b(.)35 b(Requiring)23 b(e)n(v)o(en)2218
5400 y(as)k(little)h(as)f(a)h(C)f(function)e(call)j(for)e(each)g(data)h
(access)p eop
%%Page: 4 4
4 3 bop 208 83 a Fc(w)o(ould)25 b(be)i(disastrous.)44
b(Therefore)24 b(the)j(data)f(must)h(be)208 183 y(stored)19
b(in)i(typical)e(C)i(data)f(structures.)125 350 y Fa(\017)41
b Fc(The)31 b(information)f(in)i(the)g(lo)n(w-le)n(v)o(el)f(data)h
(structures)208 450 y(should)15 b(not)i(be)g(repeated)f(in)h(the)g
(high-le)n(v)o(el)d(structures.)208 549 y(That)23 b(w)o(ould)h(be)g(a)g
(w)o(aste)h(of)f(memory)e(and)i(an)g(impor)n(-)208 649
y(tant)30 b(source)f(of)g(errors.)54 b(The)29 b(high-le)n(v)o(el)f
(data)i(struc-)208 748 y(tures)37 b(should)g(instead)g(use)h
(references)e(to)h(the)h(lo)n(w-)208 848 y(le)n(v)o(el)19
b(ones.)0 1015 y(One)h(possibility)g(w)o(ould)g(be)g(to)g(de\002ne)g
(se)n(v)o(eral)g(specialized)g(C)0 1115 y(e)o(xtension)h(types.)33
b(But)23 b(writing)f(an)h(e)o(xtension)f(type)g(in)m(v)n(olv)o(es)0
1214 y(a)h(substantial)f(ef)n(fort,)g(and)g(unless)h(the)f(data)h(is)g
(to)g(be)f(used)h(di-)0 1314 y(rectly)18 b(in)g(application)f
(programs,)g(this)h(ef)n(fort)g(is)h(not)f(justi\002ed.)0
1414 y(Ho)n(we)n(v)o(er)m(,)d(the)i(array)f(type)g(pro)o(vided)f(by)h
(the)h(numerics)f(e)o(xten-)0 1513 y(sion)g(\002ts)i(that)e
(description)f(nicely)-5 b(.)23 b(Its)17 b(internal)e(data)i(structure)
0 1613 y(is)25 b(a)g(C)h(array)-5 b(,)23 b(so)i(C)h(code)d(can)i
(access)g(it)g(ef)n(\002ciently)-5 b(.)36 b(On)25 b(the)0
1713 y(other)d(hand,)f(Python)g(code)h(can)g(easily)h(create)f(and)g
(store)g(ref-)0 1812 y(erences)f(to)h(an)o(y)e(part)h(of)g(the)h(data.)
28 b(This)22 b(approach)d(k)o(eeps)j(the)0 1912 y(C)g(modules)d(simple)
i(at)g(the)g(cost)g(of)g(some)f(added)g(comple)o(xity)0
2011 y(in)g(the)h(Python)e(code,)g(where)g(it)i(is)g(easier)g(to)f
(handle.)0 2111 y(MMTK)f(uses)g(almost)g(only)f(arrays)g(in)h(the)f
(interf)o(ace)g(between)0 2211 y(Python)g(and)g(C)h(code.)24
b(An)19 b(e)o(xample)e(is)j(the)f(storage)f(of)g(atomic)0
2311 y(con\002gurations.)28 b(At)23 b(the)f(C)g(le)n(v)o(el,)g(all)h
(positions)e(of)h(all)h(atoms)0 2410 y(in)16 b(a)g(uni)n(v)o(erse)e
(are)i(stored)f(in)h(a)g(single)g(array)e(for)h(ef)n(\002cienc)o(y)-5
b(.)22 b(At)0 2510 y(the)e(Python)f(le)n(v)o(el,)g(each)h(atom)f(has)h
(an)g(attrib)n(ute)f Fb(position)0 2609 y Fc(whose)24
b(v)n(alue)f(is)i(an)f(instance)f(of)h(the)g(class)h
Fb(Vector)p Fc(.)35 b(Class)0 2709 y Fb(Vector)18 b Fc(stores)g(its)h
(internal)f(data)g(\(three)f(coordinates\))f(in)j(an)0
2809 y(array)d(\226)h(and)f(this)i(array)e(is)i(created)e(by)g(inde)o
(xing)f(from)h(the)h(full)0 2908 y(con\002guration)27
b(array)-5 b(.)50 b(This)30 b(ensures)e(consistenc)o(y)g(between)0
3008 y(the)20 b(tw)o(o)h(system)f(descriptions.)0 3108
y(Three)37 b(of)h(the)f(four)g(C)i(modules)e(in)h(MMTK)f(co)o(v)o(er)f
(force)0 3208 y(\002eld)25 b(e)n(v)n(aluation,)e(ener)o(gy)f
(minimization,)i(and)g(computation)0 3307 y(of)e(dynamical)f
(trajectories.)32 b(The)22 b(fourth)f(one)h(pro)o(vides)e(base)0
3407 y(services)34 b(for)g(algorithms)f(that)h(create)g(trajectories,)j
(i.e.)68 b(it)0 3506 y(pro)o(vides)33 b(specialized)i(I/O)h
(operations.)68 b(One)35 b(other)f(com-)0 3606 y(putationally)16
b(e)o(xpensi)n(v)o(e)g(operation,)h(normal)g(mode)g(analysis,)0
3706 y(is)24 b(implemented)d(in)j(Python)e(using)g(the)h
Fb(LinearAlgebra)0 3805 y Fc(module)k(of)g(NumPy)-5 b(,)29
b(which)f(ultimately)f(calls)i(LAP)-8 b(A)m(CK,)28 b(a)0
3905 y(highly)i(optimized)f(linear)i(algebra)f(library)g(written)h(in)g
(F)o(or)n(-)0 4005 y(tran.)0 4105 y(An)22 b(important)f(design)g(goal)h
(in)g(MMTK)h(w)o(as)g(the)f(separation)0 4204 y(of)28
b(force)g(\002eld)h(e)n(v)n(aluation)e(and)i(the)f(algorithms)g(that)h
(call)g(it)0 4304 y(\(such)f(as)h(ener)o(gy)d(minimization\).)47
b(Since)29 b(these)f(operations)0 4403 y(are)34 b(closely)f
(intertwined)g(at)h(e)o(x)o(ecution)e(time,)37 b(it)d(is)h(tempt-)0
4503 y(ing)23 b(to)h(implement)e(them)h(together)f(in)i(one)f(module.)
33 b(In)24 b(f)o(act,)0 4603 y(this)f(is)g(what)g(most)f(modeling)f
(programs)g(do.)31 b(Ho)n(we)n(v)o(er)m(,)21 b(this)0
4702 y(creates)29 b(problems)e(for)h(later)g(e)o(xtensions:)41
b(ne)n(w)28 b(force)g(\002elds)0 4802 y(might)d(not)g(w)o(ork)g
(correctly)f(with)h(all)h(force)f(\002eld)g(users,)i(and)0
4902 y(ne)n(w)e(algorithms)e(using)i(force)f(\002eld)h(information)e
(might)h(not)0 5001 y(obtain)19 b(the)i(correct)e(force)g(\002eld.)0
5101 y(A)32 b(consequence)d(of)i(the)g(decision)g(to)h(separate)e
(these)i(tasks)0 5201 y(into)21 b(dif)n(ferent)e(modules)i(is)h(that)f
(MMTK')-5 b(s)21 b(C)h(modules)f(must)0 5300 y(communicate)15
b(among)h(each)h(other)g(in)g(an)h(ef)n(\002cient)f(w)o(ay)-5
b(.)23 b(This)0 5400 y(is)h(dif)n(ferent)c(from)i(the)h(majority)e(of)h
(C)i(modules,)e(which)g(pro-)2010 83 y(vide)h(functions)f(and)i(object)
f(types)g(to)h(be)g(used)f(from)g(Python)2010 183 y(code)h(only)-5
b(.)38 b(It)26 b(is,)g(ho)n(we)n(v)o(er)m(,)e(typical)h(for)f(man)o(y)g
(lar)o(ge)g(scien-)2010 282 y(ti\002c)d(applications.)2010
383 y(If)e(the)g(modules)e(were)i(statically)g(link)o(ed)f(to)h(the)g
(Python)f(inter)n(-)2010 483 y(preter)m(,)g(the)o(y)h(could)g(simply)g
(pro)o(vide)f(a)i(C)g(API)g(in)g(the)f(form)g(of)2010
582 y(a)g(header)e(\002le)i(to)f(be)h(included)d(by)i(client)h
(modules,)e(much)g(lik)o(e)2010 682 y(the)24 b(C)i(API)e(for)g(b)n
(uilt-in)f(Python)h(types.)37 b(Ho)n(we)n(v)o(er)m(,)23
b(the)h(pos-)2010 782 y(sibility)e(of)g(compiling)f(C)i(modules)e(into)
g(shared)h(library)f(\002les)2010 881 y(is)31 b(a)g(v)o(ery)e(con)m(v)o
(enient)e(one,)32 b(especially)e(for)f(code)h(de)n(v)o(elop-)2010
981 y(ment.)c(But)21 b(shared)f(libraries)g(can')o(t)g(simply)h(call)g
(each)f(other')-5 b(s)2010 1081 y(functions,)17 b(at)j(least)g(not)e
(under)g(all)h(operating)e(systems.)25 b(A)20 b(so-)2010
1180 y(lution)j(is)j(pro)o(vided)21 b(by)j(the)g(CObject)g(data)h
(type,)f(introduced)2010 1280 y(with)d(Python)e(1.4.)25
b(CObjects)c(simply)f(wrap)g(a)h(C)h(pointer)d(into)2010
1379 y(a)h(Python)f(object.)24 b(The)19 b(C)i(modules)e(in)h(MMTK)f
(create)h(an)g(ar)n(-)2010 1479 y(ray)i(of)h Fb(void)49
b Fa(\003)23 b Fc(in)g(which)f(the)o(y)g(store)h(the)g(addresses)f(of)h
(the)2010 1579 y(type)k(objects)g(and)g(C)h(functions)e(the)o(y)g(w)o
(ant)i(to)f(e)o(xport.)45 b(The)2010 1678 y(address)24
b(of)f(this)i(array)e(is)i(put)f(into)f(a)i(CObject,)g(which)e(is)i
(as-)2010 1778 y(signed)19 b(to)h(the)g(name)p 2659 1778
25 4 v 49 w Fb(C)p 2739 1778 V 30 w(API)f Fc(in)h(the)g(module')-5
b(s)19 b(name)g(space.)2010 1878 y(Another)d(C)j(module)d(wishing)h(to)
h(use)f(this)h(C)h(API)f(imports)f(the)2010 1977 y(module)24
b(and)h(tak)o(es)g(the)h(address)f(of)g(the)g(pointer)f(array)h(from)
2010 2077 y(the)20 b(CObject.)25 b(A)20 b(header)f(\002le)h(that)g
(comes)f(with)h(the)g(imported)2010 2176 y(module)i(de\002nes)i(the)f
(C)i(API)f(functions)e(as)j(macros)e(in)h(terms)2010
2276 y(of)c(the)g(array)f(entries.)2010 2377 y(It)e(must)h(be)f
(stressed)g(that)h(once)e(the)h(initial)h(setup)f(phase)g(is)h(\002n-)
2010 2477 y(ished,)k(the)g(time-critical)f(algorithms)g(in)h(MMTK)g(e)o
(x)o(ecute)f(as)2010 2576 y(pure)c(C)i(code)e(on)g(typical)g(C)i(data)e
(structures,)h(with)g(absolutely)2010 2676 y(no)k(o)o(v)o(erhead)d
(caused)i(by)h(the)g(Python)e(interpreter)h(or)g(the)h(use)2010
2776 y(of)d(Python)e(data)i(types.)24 b(The)19 b(o)o(v)o(erhead)d
(caused)i(by)h(the)g(use)g(of)2010 2875 y(pointer)26
b(indirection)g(for)g(function)g(calls)i(across)f(modules)g(is)2010
2975 y(ne)o(gligible,)20 b(and)g(not)h(uncommon)d(e)n(v)o(en)j(in)g
(pure)f(C)i(programs)2010 3074 y(\(not)e(to)h(mention)f(C++\).)27
b(The)21 b(only)f(disadv)n(antage)f(compared)2010 3174
y(to)29 b(a)h(straightforw)o(ard)d(C)j(implementation)c(is)31
b(a)e(more)f(com-)2010 3274 y(ple)o(x)19 b(design.)2010
3561 y Fh(6)119 b(Storing)31 b(and)f(r)n(etrie)n(ving)h(data)2010
3749 y Fc(The)c(tw)o(o)h(main)f(reasons)h(to)f(store)h(data)f(in)h
(permanent)e(\002les,)2010 3849 y(other)e(than)h(interchanging)d(data)j
(with)g(other)f(people)g(or)h(pro-)2010 3948 y(grams,)e(are)g(storing)g
(the)g(state)h(of)f(a)h(system)f(after)g(interacti)n(v)o(e)2010
4048 y(manipulations)g(for)h(later)h(reuse)f(and)g(storing)g(the)h
(result)g(of)f(a)2010 4148 y(time-consuming)29 b(operation)h(that)j(w)o
(ould)e(be)h(too)f(costly)h(to)2010 4247 y(repeat.)h(In)22
b(molecular)g(modeling,)g(the)h(objects)f(that)i(must)f(be)2010
4347 y(stored)d(frequently)e(are)2135 4517 y Fa(\017)41
b Fc(complete)19 b(uni)n(v)o(erses)2135 4688 y Fa(\017)41
b Fc(atomic)19 b(con\002gurations)f(for)i(a)g(uni)n(v)o(erse)2135
4859 y Fa(\017)41 b Fc(trajectories)26 b(\(i.e.)44 b(sequences)26
b(of)g(con\002gurations)e(and)2218 4959 y(other)19 b(data\))2135
5130 y Fa(\017)41 b Fc(normal)19 b(modes)2010 5300 y(In)30
b(MMTK,)f(e)n(v)o(erything)f(e)o(xcept)h(trajectories)g(is)i(sa)n(v)o
(ed)f(and)2010 5400 y(retrie)n(v)o(ed)18 b(using)i(the)g(standard)f
(Python)g(pickle)h(module.)j(This)p eop
%%Page: 5 5
5 4 bop 0 83 a Fc(is)24 b(easy)g(and)f(suf)n(\002ciently)g(ef)n
(\002cient,)g(and)g(generates)g(portable)0 183 y(\002les.)88
b(Ho)n(we)n(v)o(er)m(,)44 b(the)d(resulting)f(\002les)i(are)f
(unnecessarily)0 282 y(lar)o(ge,)52 b(because)45 b(the)o(y)h(contain)f
(much)h(detailed)g(informa-)0 382 y(tion)26 b(that)h(could)f(easily)h
(be)f(re)o(generated)e(instead)j(of)f(loaded.)0 482 y(This)35
b(is)h(a)g(special)f(problem)e(for)h(con\002gurations)f(and)h(nor)n(-)0
581 y(mal)28 b(modes.)49 b(Since)29 b(these)f(objects)h(contain)e(a)i
(reference)d(to)0 681 y(the)i(uni)n(v)o(erse)e(for)i(which)f(the)o(y)g
(were)h(generated,)g(the)g(whole)0 780 y(uni)n(v)o(erse)f(is)j(sa)n(v)o
(ed)e(too.)50 b(It)29 b(w)o(ould)f(be)g(nice)h(to)g(store)f(a)h(uni-)0
880 y(v)o(erse)19 b(only)g(once,)f(and)h(then)g(be)h(able)f(to)h(store)
f(con\002gurations)0 980 y(and)h(normal)e(modes)i(in)g(separate)g
(\002les)h(containing)d(just)j(a)f(ref-)0 1079 y(erence)28
b(to)h(the)g(uni)n(v)o(erse)f(\002le.)52 b(This)29 b(is)h(in)f
(principle)f(doable)0 1179 y(with)23 b(the)f(pickle)h(module,)e(b)n(ut)
i(man)o(y)e(details)i(are)g(not)f(yet)h(re-)0 1279 y(solv)o(ed.)g(It)c
(may)g(be)f(preferable)f(to)i(switch)g(to)f(a)i(dif)n(ferent)c(stor)n
(-)0 1378 y(age)k(method.)0 1485 y(T)m(rajectories)j(are)g(dif)n
(ferent)f(in)i(that)f(the)o(y)g(can)g(become)g(much)0
1585 y(lar)o(ger)g(than)h(computer)f(memory)-5 b(.)35
b(The)o(y)24 b(ha)n(v)o(e)f(to)i(be)f(created)0 1684
y(directly)16 b(in)i(disk)f(\002les,)h(and)f(read)g(in)g(piece)n(wise,)
h(which)e(w)o(ould)0 1784 y(be)25 b(dif)n(\002cult)g(to)g(arrange)e
(with)j(the)f(pickle)f(module.)39 b(In)24 b(addi-)0 1884
y(tion,)k(the)g(creation)e(of)g(trajectories)h(must)g(be)g(ef)n
(\002cient,)h(both)0 1983 y(in)19 b(CPU)i(time)e(and)g(in)g(disk)g
(space)g(usage.)25 b(Therefore)17 b(MMTK)0 2083 y(uses)32
b(the)f(netCDF)h(\002le)g(format)e([netCDF])h(for)g(its)h(trajecto-)0
2183 y(ries.)38 b(The)24 b(netCDF)h(format)e(is)j(portable)d(between)g
(machines)0 2282 y(and)32 b(operating)f(systems,)36 b(and)c(an)h(ef)n
(\002cient)f(free)g(library)g(is)0 2382 y(a)n(v)n(ailable)24
b(to)g(read)f(and)h(write)g(the)g(\002les)h(from)e(C)i(and)f(F)o
(ortran)0 2481 y(programs.)e(A)d(Python)e(interf)o(ace)g(module)g(is)i
(a)n(v)n(ailable)f(which)0 2581 y(lets)f(Python)d(programs)g(access)j
(netCDF)f(v)n(ariables)f(much)g(lik)o(e)0 2681 y(NumPy)k(arrays)h
([Python/netCDF)n(].)0 2788 y(Since)26 b(trajectories)f(are)h(not)f
(written)h(in)g(pickle)f(format,)h(the)o(y)0 2887 y(do)32
b(not)g(automatically)f(contain)h(a)h(description)e(of)h(the)g(uni-)0
2987 y(v)o(erse)h(the)o(y)g(belong)f(to.)66 b(Such)33
b(a)h(description)f(is)h(desirable)0 3087 y(both)d(to)h(allo)n(w)g(v)o
(eri\002cation)e(when)h(a)h(trajectory)f(is)h(opened)0
3186 y(again)23 b(for)h(reading,)g(and)g(to)h(mak)o(e)f(the)g
(trajectory)g(fully)f(self-)0 3286 y(describing,)31 b(i.e.)57
b(to)31 b(allo)n(w)f(analysis)h(of)f(a)h(trajectory)f(with-)0
3385 y(out)f(needing)e(additional)h(\002les.)53 b(One)29
b(possibility)f(w)o(ould)h(be)0 3485 y(to)c(store)g(a)h(pickle)e
(string)h(in)g(the)g(\002le,)i(b)n(ut)e(CPU)h(time,)g(mem-)0
3585 y(ory)-5 b(,)24 b(and)h(disk)f(space)h(use)g(w)o(ould)f(be)h
(substantial.)38 b(Instead)24 b(a)0 3684 y(minimal)18
b(description)g(of)g(the)h(uni)n(v)o(erse)f(is)i(stored)e(in)h(a)g
(special)0 3784 y(string)29 b(format.)51 b(This)30 b(string)f(can)g(be)
g(e)o(x)o(ecuted)f(in)h(the)g(con-)0 3884 y(te)o(xt)g(of)f(a)h(special)
g(module)f(to)h(construct)f(a)h(uni)n(v)o(erse)e(which)0
3983 y(matches)g(the)h(original)f(one)g(in)h(structure)e(\(i.e.)48
b(contains)27 b(the)0 4083 y(same)32 b(molecules\),)h(b)n(ut)e(not)g
(necessarily)g(in)h(other)e(features)0 4182 y(that)21
b(are)g(irrele)n(v)n(ant)e(for)h(the)h(interpretation)d(of)j(the)g
(trajectory)-5 b(.)0 4282 y(Construction)31 b(and)h(reinterpretation)f
(of)h(this)h(string)g(format)0 4382 y(are)c(v)o(ery)e(f)o(ast,)k(and)e
(it)g(is)h(much)d(smaller)i(than)f(a)i(full)e(pickle)0
4481 y(representation.)23 b(It)d(might)f(be)h(possible)g(to)g
(implement)f(a)h(gen-)0 4581 y(eral)k(library)f(module)g(for)g(storing)
h(and)f(retrie)n(ving)g(objects)g(in)0 4681 y(such)j(a)g(format.)41
b(It)26 b(w)o(ould)f(require)f(more)h(support)g(from)g(the)0
4780 y(classes)c(that)g(use)f(it,)h(b)n(ut)f(of)n(fer)f(ef)n(\002cienc)
o(y)g(in)h(return.)0 5101 y Fh(7)119 b(MMTK)30 b(in)g(practice)0
5300 y Fc(Although)14 b(MMTK)i(is)h(still)h(young)c(and)i(does)g(not)f
(ha)n(v)o(e)h(a)h(lar)o(ge)0 5400 y(user)j(base,)g(it)g(has)g(been)f
(used)h(successfully)f(for)h(real)f(research)2010 83
y(problems,)30 b(mostly)e(for)h(analyzing)e(data)i(from)f(e)o
(xperiments)2010 183 y(or)j(simulations)g(performed)e(with)j(other)f
(programs.)57 b(Some)2010 282 y(of)19 b(these)g(analyses)g(w)o(ould)f
(ha)n(v)o(e)h(been)f(prohibiti)n(v)o(ely)f(compli-)2010
382 y(cated)j(using)g(traditional)f(tools.)2010 489 y(The)35
b(most)g(important)e(adv)n(antage)g(is)j(the)f(easy)h(inte)o(gration)
2010 589 y(with)c(other)g(Python)f(modules)g(and)g(e)o(xternal)g
(programs)f(for)2010 688 y(which)19 b(Python)e(interf)o(ace)i(modules)f
(e)o(xist)h(\(e.g.)24 b(visualization)2010 788 y(and)k(plotting)g
(programs\).)48 b(Examples)28 b(of)g(non-standard)e(vi-)2010
887 y(sualization)f(tasks)i(that)f(were)g(made)g(easy)g(by)g(MMTK)g
(\(plus)2010 987 y(a)41 b(VRML)g(vie)n(wer\))e(are)h(a)h(char)o(ge)e
(visualization)g(realized)2010 1087 y(by)34 b(color)n(-coding)e(atoms)j
(according)e(to)i(their)g(char)o(ge,)h(and)2010 1186
y(\223static\224)d(trajectory)d(visualization)h(by)h(lines)g
(indicating)f(the)2010 1286 y(paths)20 b(of)g(selected)g(atoms.)2010
1393 y(Another)32 b(adv)n(antage)f(is)j(the)f(ease)g(of)g(using)f(MMTK)
h(inter)n(-)2010 1493 y(acti)n(v)o(ely)-5 b(.)53 b(Since)29
b(the)h(bare)g(Python)e(interpreter)g(is)j(not)f(v)o(ery)2010
1592 y(con)m(v)o(enient)d(for)i(longer)g(interacti)n(v)o(e)f(sessions,)
33 b(it)d(is)h(recom-)2010 1692 y(mended)d(to)i(use)g(either)g(Emacs)f
(with)h(Python)f(mode)g(or)h(the)2010 1791 y(Tk-based)j(GUI)i(package)e
(PTUI)h([PTUI)o(].)68 b(The)34 b(combina-)2010 1891 y(tion)39
b(with)g(PTUI)g(again)e(demonstrates)h(the)h(adv)n(antage)e(of)2010
1991 y(MMTK')-5 b(s)20 b(library)f(approach.)2010 2098
y(A)f(not)g(yet)f(satisf)o(actorily)h(resolv)o(ed)e(problem)g(with)i
(MMTK)g(is)2010 2197 y(documentation.)38 b(There)25 b(is)h(a)g(user)g
(manual)e(which)i(e)o(xplains)2010 2297 y(the)20 b(objects)g(and)g
(functions)e(that)i(are)g(of)g(interest)g(to)h(scientists)2010
2396 y(who)i(w)o(ant)h(to)g(apply)f(the)h(techniques)e(pro)o(vided)g
(by)h(MMTK.)2010 2496 y(Ho)n(we)n(v)o(er)m(,)16 b(scientists)j(in)m(v)n
(olv)o(ed)c(in)j(the)g(de)n(v)o(elopment)d(and)i(im-)2010
2596 y(plementation)g(of)h(techniques)g(need)g(much)g(more)g(detailed)g
(in-)2010 2695 y(formation.)57 b(A)32 b(de)n(v)o(eloper)d(manual)h
(describing)g(the)h(design)2010 2795 y(concepts)e(will)i(ha)n(v)o(e)e
(to)h(be)g(pro)o(vided,)f(and)h(documentation)2010 2895
y(of)e(indi)n(vidual)f(modules)g(with)i(comments)e(and)h(documenta-)
2010 2994 y(tion)23 b(strings)h(will)h(ha)n(v)o(e)e(to)h(be)f(impro)o
(v)o(ed.)33 b(In)24 b(addition,)f(a)h(tu-)2010 3094 y(torial)g(for)g
(be)o(ginners)e(and)i(people)f(coming)g(from)g(traditional)2010
3194 y(programs)18 b(w)o(ould)i(be)g(highly)f(desirable.)2010
3300 y(A)33 b(frequent)e(question)h(is)i(whether)e(MMTK)h(is)g(suf)n
(\002ciently)2010 3400 y(f)o(ast)38 b(for)f(practical)f(w)o(ork.)76
b(The)37 b(parts)g(written)g(in)h(Python)2010 3500 y(were)28
b(certainly)f(f)o(ast)h(enough)e(to)i(deal)g(with)g(the)g(analysis)g
(of)2010 3599 y(lar)o(ge-scale)d(domain)g(motion)g(in)h(a)h(26000-atom)
c(protein)i(in-)2010 3699 y(teracti)n(v)o(ely)d(on)h(a)g(200)f(MHz)i
(PentiumPro)e(machine)g(running)2010 3799 y(Linux.)68
b(The)35 b(time-critical)f(routines)h(are)g(written)f(entirely)2010
3898 y(in)e(C)g(and)f(don')o(t)e(use)j(an)o(y)e(Python)h(features)f
(once)h(the)o(y)g(are)2010 3998 y(started,)19 b(so)g(the)o(y)e(are)i
(just)g(as)h(ef)n(\002cient)e(as)h(an)o(y)f(other)g(C)h(imple-)2010
4098 y(mentation.)2010 4204 y(Ho)n(we)n(v)o(er)m(,)26
b(there)g(is)h(some)g(o)o(v)o(erhead)d(caused)i(by)g(the)g(design)2010
4304 y(decision)h(to)h(gi)n(v)o(e)f(safety)-5 b(,)30
b(ease)e(of)g(use,)h(and)f(\003e)o(xibility)f(pri-)2010
4404 y(ority)32 b(o)o(v)o(er)f(speed.)63 b(An)32 b(e)o(xample:)49
b(F)o(or)33 b(lar)o(ger)e(systems,)36 b(a)2010 4503 y(signi\002cant)23
b(amount)f(of)h(CPU)h(time)f(is)h(spent)f(calculating)g(the)2010
4603 y(distance)k(v)o(ectors)g(between)f(atoms.)47 b(This)28
b(is)g(a)g(tri)n(vial)f(oper)n(-)2010 4703 y(ation,)34
b(taking)e(ne)o(gligible)e(CPU)j(time,)i(b)n(ut)d(the)g(code)f(to)i(be)
2010 4802 y(used)26 b(depends)f(on)g(the)i(geometry)d(of)i(the)g
(simulated)f(system)2010 4902 y(\(e.g.)16 b(periodic)f(boundary)e
(conditions\).)22 b(Most)17 b(modeling)e(pro-)2010 5001
y(grams)23 b(implement)g(a)h(\002x)o(ed)f(set)h(of)g(allo)n(wed)f
(geometries)f(and)2010 5101 y(hard-code)j(the)j(corresponding)d
(formulas.)47 b(MMTK)27 b(allo)n(ws)2010 5201 y(ne)n(w)d(geometries)f
(to)h(be)g(de\002ned)f(without)g(an)o(y)h(change)e(to)j(its)2010
5300 y(code,)c(at)h(the)f(cost)h(of)f(an)h(indirect)e(function)g(call)i
(for)f(distance)2010 5400 y(v)o(ector)e(calculation,)f(which)h(is)i
(used)e(in)h(the)g(inner)f(loop)g(of)h(the)p eop
%%Page: 6 6
6 5 bop 0 83 a Fc(most)19 b(time-critical)f(calculation.)23
b(Ev)o(entually)17 b(a)i(compromise)0 183 y(will)27 b(ha)n(v)o(e)g(to)f
(be)h(found,)f(e.g.)45 b(hard-coding)23 b(the)k(most)f(com-)0
282 y(mon)17 b(geometries)h(while)g(still)h(allo)n(wing)f(e)o(xternal)f
(de\002nitions.)0 382 y(It)k(is)h(dif)n(\002cult)f(to)g(compare)e(the)j
(computational)c(ef)n(\002cienc)o(y)i(of)0 482 y(dif)n(ferent)f
(modeling)g(packages,)h(because)g(there)h(are)g(so)g(man)o(y)0
581 y(v)n(ariations)32 b(of)h(the)g(basic)g(algorithms)f(that)h(af)n
(fect)f(speed)h(as)0 681 y(well)g(as)g(suitability)f(for)f(v)n(arious)g
(applications.)60 b(Ne)n(v)o(erthe-)0 780 y(less,)29
b(to)e(gi)n(v)o(e)g(a)g(rough)e(idea)i(of)f(the)h(performance)d(to)j
(be)g(e)o(x-)0 880 y(pected,)k(a)g(small)f(real-life)g(application)e
(\(equilibration)f(of)j(a)0 980 y(system)c(of)f(300)f(w)o(ater)i
(molecules)f(with)g(periodic)f(boundary)0 1079 y(conditions\))18
b(w)o(as)j(done)e(with)i(both)e(MMTK)h(and)g(CHARMM)0
1179 y([CHARMM].)68 b(CHARMM)35 b(is)g(a)g(widely)f(used)g(modeling)0
1279 y(program)17 b(written)i(in)h(F)o(ortran-77)d(with)i(a)h
(reputation)e(for)g(both)0 1378 y(ef)n(\002cienc)o(y)25
b(and)i(user)f(frustration.)44 b(On)27 b(a)g(PentiumPro)e(com-)0
1478 y(puter)i(under)f(Linux,)i(using)f(gcc)h(and)f(g77)g(for)g
(compilation,)0 1577 y(CHARMM)35 b(w)o(as)h(2.5)e(times)h(f)o(aster)-5
b(.)68 b(On)35 b(the)f(other)g(hand,)0 1677 y(the)28
b(MMTK)f(application)g(consists)h(of)f(se)n(v)o(en)h(Python)e(state-)0
1777 y(ments)h(and)h(w)o(ork)o(ed)e(correctly)g(the)i(\002rst)g(time,)h
(whereas)f(the)0 1876 y(CHARMM)43 b(input)f(\002le)h(contains)f(20)g
(statements)g(\(in)h(the)0 1976 y(CHARMM)22 b(scripting)f(language,)f
(which)h(is)h(more)f(program-)0 2076 y(oriented)30 b(than)h
(problem-oriented\),)f(w)o(ork)o(ed)g(only)h(after)g(an)0
2175 y(hour)25 b(of)g(trial-and-error)e(modi\002cation,)j(and)f
(required)f(man-)0 2275 y(ual)d(editing)f(of)h(the)g(input)g(geometry)e
(\002le,)i(although)f(it)i(w)o(as)f(in)0 2374 y(a)26
b(widely)e(used)h(standard)f(format.)39 b(The)25 b(total)g(time)g
(required)0 2474 y(for)f(this)i(mini)e(project)g(w)o(as)i(therefore)d
(signi\002cantly)h(smaller)0 2574 y(with)c(MMTK.)0 2847
y Fh(8)119 b(Futur)n(e)31 b(de)n(v)o(elopments)0 3033
y Fc(Compared)17 b(to)i(the)f(popular)f(traditional)g(modeling)g
(packages,)0 3132 y(MMTK)24 b(is)h(still)g(lacking)e(man)o(y)g
(features.)36 b(This)25 b(is)g(to)f(be)g(e)o(x-)0 3232
y(pected,)16 b(gi)n(v)o(en)g(that)g(MMTK)h(w)o(as)g(written)g(by)f(a)h
(single)g(person)0 3332 y(during)30 b(about)h(one)g(year)h(as)g(a)h
(part-time)d(project,)k(whereas)0 3431 y(other)40 b(programs)f
(represent)h(the)h(w)o(ork)f(of)h(lar)o(ge)e(research)0
3531 y(groups)20 b(during)g(se)n(v)o(eral)h(years.)29
b(More)21 b(modeling)f(techniques)0 3630 y(will)k(be)e(implemented)f
(as)j(the)f(need)f(arises)h(and)f(as)i(time)f(per)n(-)0
3730 y(mits.)44 b(Man)o(y)25 b(established)g(techniques)g(that)i(are)f
(not)f(yet)i(im-)0 3830 y(plemented)21 b(ha)n(v)o(e)i(ne)n(v)o
(ertheless)e(been)i(considered)e(in)i(the)g(de-)0 3929
y(sign)d(phase)g(and)g(should)f(therefore)f(not)i(cause)g(dif)n
(\002culties.)0 4029 y(Some)27 b(possible)g(future)f(de)n(v)o
(elopments)e(are)j(particularly)f(in-)0 4129 y(teresting)20
b(and/or)f(important:)125 4264 y Fa(\017)41 b Fc(P)o(arallelization)29
b(of)g(the)h(time-critical)g(computational)208 4364 y(techniques.)e
(The)22 b(bookk)o(eeping)c(tasks)23 b(could)e(be)g(han-)208
4464 y(dled)f(in)h(Python,)f(lea)n(ving)g(only)h(a)g(small)h(part)e(of)
h(hand-)208 4563 y(parallelized)16 b(C)i(code)f(that)h(could)f(be)g
(hard)g(to)g(write)h(and)208 4663 y(test.)125 4814 y
Fa(\017)41 b Fc(De)n(v)o(elopment)28 b(of)j(GUI-based)f(tools)h
(\(using)f(Tk\))g(for)208 4913 y(some)20 b(standard)f(tasks)h(on)g(top)
g(of)g(MMTK.)125 5064 y Fa(\017)41 b Fc(Distrib)n(uted)34
b(computing:)52 b(number)33 b(crunching)g(on)h(a)208
5164 y(supercomputer)m(,)25 b(setup)i(and)g(analysis)h(on)f(a)g(w)o
(orksta-)208 5264 y(tion.)d(This)d(could)e(be)h(realized)f(via)i(ILU.)
2135 83 y Fa(\017)41 b Fc(Interf)o(ace)15 b(modules)g(for)h(dealing)g
(with)g(foreign)f(\002le)i(for)n(-)2218 183 y(mats,)22
b(to)g(allo)n(w)g(a)g(progressi)n(v)o(e)d(transition)i(from)g(tradi-)
2218 282 y(tional)e(tools.)2010 572 y Fh(9)119 b(Conclusion)2010
761 y Fc(The)27 b(MMTK)f(project)h(has)g(sho)n(wn)f(that)h(Python)f(is)
i(not)e(only)2010 860 y(a)j(viable,)i(b)n(ut)d(a)i(v)o(ery)d
(appropriate)g(language)g(for)h(scienti\002c)2010 960
y(computing.)82 b(It)41 b(allo)n(ws)f(to)g(pro)o(vide)e(a)j
(problem-oriented)2010 1060 y(object-oriented)g(vie)n(w)j(for)g(the)g
(user)g(and)f(an)h(algorithm-)2010 1159 y(oriented)25
b(lo)n(w-le)n(v)o(el)f(one)i(for)f(routines)g(in)h(C)h(or)f(F)o(ortran)
e(that)2010 1259 y(deal)e(with)g(the)g(numerically)e(intensi)n(v)o(e)h
(parts)h(of)g(the)g(applica-)2010 1358 y(tion.)2010 1460
y(Based)38 b(on)f(the)g(e)o(xperience)e(with)j(MMTK,)f(the)g(follo)n
(wing)2010 1559 y(recommendations)14 b(seem)k(appropriate)c(for)j
(scienti\002c)h(Python)2010 1659 y(applications)h(in)h(general:)2135
1830 y Fa(\017)41 b Fc(Don')o(t)19 b(write)h(programs,)e(write)i
(libraries.)2135 2003 y Fa(\017)41 b Fc(Design)59 b(the)h(user)n
(-visible)f(objects)h(in)g(a)g(strictly)2218 2103 y(problem-oriented)32
b(w)o(ay)-5 b(.)72 b(Don')o(t)34 b(force)h(the)i(user)e(to)2218
2202 y(deal)20 b(with)g(lo)n(w-le)n(v)o(el)f(implementation)f(details.)
2135 2375 y Fa(\017)41 b Fc(Use)24 b(arrays)e(at)i(the)g(Python-C)e
(interf)o(ace)g(for)h(data)g(that)2218 2475 y(has)d(to)g(be)g(accessed)
h(from)e(both)g(sides.)2135 2648 y Fa(\017)41 b Fc(Pro)o(vide)20
b(a)i(C)h(API)f(via)g(CObjects)g(for)f(C)i(modules)d(that)2218
2747 y(might)f(be)h(used)g(directly)g(from)f(other)g(C)i(modules.)2135
2920 y Fa(\017)41 b Fc(As)21 b(al)o(w)o(ays:)k(don')o(t)19
b(for)o(get)f(documentation.)2010 3092 y(A)47 b(potential)e(problem)f
(is)j(that)f(follo)n(wing)f(these)h(recom-)2010 3191
y(mendations)21 b(requires)h(e)o(xtensi)n(v)o(e)g(e)o(xperience)f(not)h
(only)g(with)2010 3291 y(Python,)d(b)n(ut)g(also)h(with)g(C.)h(Most)f
(scientists)h(do)e(not)h(ha)n(v)o(e)f(this)2010 3390
y(e)o(xperience)25 b(and)i(might)g(not)g(be)g(willing)h(or)f(able)g(to)
h(acquire)2010 3490 y(it.)47 b(A)28 b(much)f(more)g(popular)e(language)
h(in)i(science,)h(in)e(spite)2010 3590 y(of)e(its)i(man)o(y)d
(shortcomings,)h(is)h(F)o(ortran.)40 b(Mix)o(ed)25 b(F)o(ortran-C)2010
3689 y(programming)f(is)k(possible)f(on)g(most)h(machines)e(and)h(w)o
(ould)2010 3789 y(allo)n(w)33 b(the)g(use)g(of)g(F)o(ortran)f(routines)
g(in)h(Python)f(e)o(xtension)2010 3889 y(modules.)24
b(T)-7 b(o)20 b(be)g(attracti)n(v)o(e)f(to)h(scientists,)h(ho)n(we)n(v)
o(er)m(,)d(such)i(an)2010 3988 y(interf)o(acing)h(w)o(ould)g(ha)n(v)o
(e)h(to)h(be)f(doable)f(with)i(no)f(kno)n(wledge)2010
4088 y(of)28 b(C.)g(Automatic)f(interf)o(ace)g(generators,)h(similar)g
(to)g(SWIG)2010 4187 y(for)f(C)i(and)e(C++)h(code)f([SWIG],)j(are)d
(possible,)i(and)f(indeed)2010 4287 y(ha)n(v)o(e)19 b(been)g(discussed)
h([FIDL)o(],)g(b)n(ut)g(no)f(such)h(tool)f(is)i(actually)2010
4387 y(a)n(v)n(ailable)k(today)-5 b(.)39 b(It)26 b(w)o(ould)f(be)g(an)h
(important)e(step)h(to)h(mak)o(e)2010 4486 y(Python)19
b(more)g(attracti)n(v)o(e)h(to)g(the)g(scienti\002c)h(community)-5
b(.)2010 4776 y Fh(10)119 b(Ackno)o(wledgements)2010
4965 y Fc(The)26 b(author)f(w)o(ould)h(lik)o(e)h(to)f(thank)g(the)g
(early)g(MMTK)g(users)2010 5064 y(for)17 b(their)h(feedback,)e(the)h
(entire)h(Python)e(community)g(for)h(help)2010 5164 y(with)29
b(man)o(y)f(problems,)h(and)f(the)h(Human)f(Frontier)g(Science)2010
5264 y(Project)20 b(Or)o(ganization)d(for)j(\002nancial)f(support.)p
eop
%%Page: 7 7
7 6 bop 0 83 a Fh(Refer)n(ences)0 269 y Fc([MMTK])40
b(The)20 b(Molecular)f(Modelling)g(T)-7 b(oolkit)19 b(is)i(a)n(v)n
(ailable)f(at)180 368 y Fb(http://starship.skyport.net/crew/h)o(insen/)
o(mmtk.)o(html)p Fc(.)0 534 y([Basis])42 b(The)20 b(Basis)h(Code)f(De)n
(v)o(elopment)e(System,)i(written)g(at)h(LLNL,)e(is)i(a)n(v)n(ailable)f
(at)180 634 y Fb(http://www-phys.llnl.gov/X)p 1485 634
25 4 v 25 w(Div/htdocs/basis.html)p Fc(.)0 800 y([NumPy])40
b(The)19 b(numerics)g(e)o(xtension,)g(written)h(by)g(Jim)g(Hugunin,)f
(is)i(a)n(v)n(ailable)e(at)180 900 y Fb
(http://www.sls.lcs.mit.edu/jjh/num)o(py/)p Fc(.)0 1066
y([netCDF])41 b(The)20 b(Unidata)f(netCDF)i(format)e(and)h(library)f
(is)i(a)n(v)n(ailable)f(at)180 1165 y Fb
(http://www.unidata.ucar.edu/packag)o(es/net)o(cdf/)p
Fc(.)0 1331 y([Python/netCDF])39 b(The)20 b(netCDF)h(interf)o(ace)e
(module,)g(written)g(by)h(K)m(onrad)f(Hinsen,)h(is)h(a)n(v)n(ailable)f
(at)180 1431 y Fb(http://starship.skyport.net/crew/h)o(insen/)o(netcd)o
(f.htm)o(l)p Fc(.)0 1597 y([PTUI])40 b(The)20 b(user)g(interf)o(ace)g
(package)e(PTUI,)i(written)g(by)g(Zachary)f(Roadhouse,)f(is)j(a)n(v)n
(ailable)f(at)180 1697 y Fb(http://starship.skyport.net/crew/z)o
(ack/pt)o(ui/)p Fc(.)0 1863 y([CHARMM])41 b(B.R.)21 b(Brooks,)e(R.E.)i
(Bruccoleri,)e(B.D.)h(Olafson,)g(D.J.)g(States,)h(S.)g(Sw)o(aminathan,)
d(and)i(M.)g(Karplus,)180 1962 y Fd(CHARMM,)g(A)h(Pr)l(o)o(gr)o(am)f
(for)g(Macr)l(omolecular)f(Ener)m(gy)-5 b(,)20 b(Minimization,)f(and)h
(Dynamics)f(Calculations)p Fc(,)180 2062 y(J.)i(Comp.)e(Chem.)h(4)g
(\(1983\))e(p.)i(187-217.)0 2228 y([SWIG])41 b(The)20
b(Simpli\002ed)g(Wrapper)f(and)g(Interf)o(ace)g(Generator)g(\(SWIG\),)h
(written)g(by)g(Da)n(vid)g(Beazly)-5 b(,)19 b(is)i(a)n(v)n(ailable)f
(at)180 2328 y Fb(http://www.cs.utah.edu/\230beazley/SW)o(IG/swi)o
(g.htm)o(l)p Fc(.)0 2494 y([FIDL])40 b(The)20 b(FIDL)g(project)g(has)g
(been)g(presented)e(by)i(Jim)h(Fulton)f(at)g(a)h(pre)n(vious)e(Python)g
(w)o(orkshop)f(\(see)180 2593 y Fb(http://www.python.org/workshops/19)o
(95-05/)o(extMo)o(dules)o(Notes.)o(html)p Fc(\))o(,)d(b)n(ut)20
b(ne)n(v)o(er)f(been)180 2693 y(completed.)p eop
%%Trailer
end
userdict /end-hook known{end-hook}if
%%EOF
